<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Geometrie Challenge - 5. Klasse</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">
    <div id="app" class="min-h-screen flex flex-col items-center p-4">
        <div class="w-full max-w-2xl mb-6 flex justify-between items-center bg-white p-4 rounded-xl shadow-sm border border-slate-200">
            <div class="flex items-center gap-3">
                <a href="index.html" class="p-2 bg-slate-100 rounded-lg hover:bg-slate-200 transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-6-6 6-6"/></svg>
                </a>
                <div>
                    <h1 class="font-bold text-lg leading-tight">Geometrie</h1>
                    <p class="text-[10px] text-cyan-600 uppercase tracking-widest font-bold">Umfang & Flächen</p>
                </div>
            </div>
            <div id="progress-container" class="text-right">
                <div id="step-label" class="text-xs font-bold text-cyan-600 mb-1">Aufgabe 1/10</div>
                <div class="w-24 h-2 bg-slate-100 rounded-full overflow-hidden">
                    <div id="progress-bar" class="h-full bg-cyan-500 transition-all duration-500" style="width: 10%"></div>
                </div>
            </div>
        </div>
        <main id="main-content" class="w-full max-w-2xl"></main>
    </div>

    <script>
        let currentStep = 0;
        let seed = Date.now();
        let gameState = 'playing';
        let options = [];
        let correctIdx = -1;

        function getSeededRandom(min, max, offset = 0) {
            const x = Math.sin(seed + currentStep + offset) * 10000;
            return Math.floor((x - Math.floor(x)) * (max - min + 1)) + min;
        }

        const questions = [
            () => {
                const a = getSeededRandom(5, 10);
                const b = getSeededRandom(2, 4);
                const u = 2 * (a + b);
                return { 
                    text: `Berechne den Umfang (U) dieses Rechtecks.`, 
                    visual: `<svg width="200" height="100" viewBox="0 0 200 100" class="mx-auto"><rect x="10" y="10" width="180" height="60" fill="none" stroke="#0891b2" stroke-width="3"/><text x="100" y="90" text-anchor="middle" font-size="12">${a} cm</text><text x="195" y="45" text-anchor="start" font-size="12">${b} cm</text></svg>`,
                    options: [`${u} cm`, `${a*b} cm`, `${u+2} cm`], 
                    correct: `${u} cm`, 
                    hint: "Umfang = Seite + Seite + Seite + Seite." 
                };
            },
            () => {
                const s = getSeededRandom(4, 8);
                const a = s * s;
                return { 
                    text: `Berechne die Fläche (A) dieses Quadrats.`, 
                    visual: `<svg width="120" height="120" viewBox="0 0 120 120" class="mx-auto"><rect x="10" y="10" width="100" height="100" fill="#cffafe" stroke="#0891b2" stroke-width="3"/><text x="60" y="120" text-anchor="middle" font-size="12">Seite s = ${s} cm</text></svg>`,
                    options: [`${a} cm²`, `${s*4} cm²`, `${a+s} cm²`], 
                    correct: `${a} cm²`, 
                    hint: "Fläche beim Quadrat = Seite mal Seite." 
                };
            },
            () => {
                return { text: "Wie viele Ecken hat ein Quader?", options: ["8", "6", "12"], correct: "8", hint: "Denk an einen Würfel: 4 Ecken oben, 4 Ecken unten." };
            },
            () => {
                const l = 10, b = 5;
                return { text: "Ein Rechteck hat einen Umfang von 30 cm. Die Länge ist 10 cm. Wie breit ist es?", options: ["5 cm", "10 cm", "20 cm"], correct: "5 cm", hint: "Umfang ist 10 + 10 + breit + breit = 30." };
            },
            () => {
                return { text: "Wie nennt man eine Linie, die genau durch die Mitte eines Kreises geht?", options: ["Durchmesser", "Radius", "Umfang"], correct: "Durchmesser", hint: "Der Durchmesser teilt den Kreis in zwei Hälften." };
            }
            // ... weitere Aufgaben folgen dem gleichen Schema
        ];

        function render() {
            const main = document.getElementById('main-content');
            if (gameState === 'fail') {
                main.innerHTML = `<div class="bg-white p-8 rounded-2xl shadow-xl text-center border-t-8 border-red-500">
                    <h2 class="text-2xl font-bold mb-4 text-red-600">Leider falsch!</h2>
                    <p class="mb-8">In der Geometrie muss man genau hinschauen. Probier es nochmal!</p>
                    <button onclick="location.reload()" class="w-full bg-slate-800 text-white font-bold py-4 rounded-xl shadow-lg">Neustart</button>
                </div>`;
                return;
            }
            if (gameState === 'success' || currentStep >= questions.length) {
                main.innerHTML = `<div class="bg-white p-8 rounded-2xl shadow-xl text-center border-t-8 border-green-500">
                    <h2 class="text-3xl font-black mb-4 text-cyan-700">GEOMETRIE-PROFI!</h2>
                    <p class="mb-8">Du hast ein super Auge für Formen.</p>
                    <a href="index.html" class="block w-full bg-slate-800 text-white font-bold py-4 rounded-xl shadow-lg mb-4 text-center">Zur Übersicht</a>
                </div>`;
                return;
            }
            const q = questions[currentStep]();
            options = q.options;
            correctIdx = q.options.indexOf(q.correct);
            document.getElementById('step-label').innerText = `Aufgabe ${currentStep+1}/${questions.length}`;
            document.getElementById('progress-bar').style.width = `${((currentStep+1)/questions.length)*100}%`;
            main.innerHTML = `<div class="bg-white p-6 rounded-2xl shadow-xl border border-slate-200">
                <p class="text-lg font-bold mb-6 text-center">${q.text}</p>
                ${q.visual ? `<div class="mb-8 p-4 bg-slate-50 rounded-xl">${q.visual}</div>` : ''}
                <div class="grid gap-3" id="options-container">
                    ${q.options.map((o, i) => `<button onclick="check(${i})" class="w-full p-4 rounded-xl border-2 border-slate-100 hover:border-cyan-400 font-semibold transition-all bg-white text-left">${o}</button>`).join('')}
                </div>
            </div><div class="mt-4 p-4 bg-cyan-50 border border-cyan-100 rounded-xl text-xs text-cyan-700"><b>Tipp:</b> ${q.hint}</div>`;
        }

        function check(index) {
            const btns = document.querySelectorAll('#options-container button');
            if (index === correctIdx) {
                btns[index].classList.add('bg-green-50', 'border-green-500');
                setTimeout(() => { currentStep++; render(); }, 600);
            } else {
                btns[index].classList.add('bg-red-50', 'border-red-500');
                setTimeout(() => { gameState = 'fail'; render(); }, 600);
            }
        }
        render();
    </script>
</body>
</html>